import requests
import json

URL = "https://api.osv.dev/v1/query"

"""
function to talk with the api 
param1: package name
param2: package version
returns json of vulnerabilities found
"""
def get_vulns(pakage, version):
    try:
        # Define the data payload
        payload = {
            "package": {
                "name": pakage
            },
            "version": version
        }
        # Convert the payload to JSON
        json_payload = json.dumps(payload)
        # Send the POST request
        response = requests.post(URL, data=json_payload)
        return json.loads(response.text)
    except:
        return response.status_code